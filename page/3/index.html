<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>chic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="chic">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="chic">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="chic" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">chic</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-coding/2024-11-20-Python-asyncio异步转同步" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/11/20/coding/2024-11-20-Python-asyncio%E5%BC%82%E6%AD%A5%E8%BD%AC%E5%90%8C%E6%AD%A5/" class="article-date">
  <time class="dt-published" datetime="2024-11-20T05:04:32.000Z" itemprop="datePublished">2024-11-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/debug/">debug</a>►<a class="article-category-link" href="/categories/debug/coding/">coding</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/11/20/coding/2024-11-20-Python-asyncio%E5%BC%82%E6%AD%A5%E8%BD%AC%E5%90%8C%E6%AD%A5/">Python-asyncio异步转同步</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在Python编程中，异步编程（Asynchronous Programming）和同步编程（Synchronous Programming）是两种常见的编程范式。理解如何在这两者之间转换，对于在实际项目中有效利用异步特性以及与现有同步代码集成至关重要。本文将详细介绍如何将Python中的异步代码转换为同步代码，涵盖<code>run_coroutine_threadsafe</code>等方法，以及异步生成器（<code>async_gen</code>）的转换。</p>
<h2 id="一、异步与同步编程概述"><a href="#一、异步与同步编程概述" class="headerlink" title="一、异步与同步编程概述"></a>一、异步与同步编程概述</h2><h3 id="1-1-同步编程"><a href="#1-1-同步编程" class="headerlink" title="1.1 同步编程"></a>1.1 同步编程</h3><ul>
<li><strong>执行模型</strong>：同步编程按照指令的顺序逐步执行，每个操作必须等待前一个操作完成后才开始。</li>
<li><strong>优点</strong>：直观、简单，易于理解和调试。</li>
<li><strong>缺点</strong>：在处理I&#x2F;O密集型任务时，可能导致性能瓶颈，因为程序会等待I&#x2F;O操作完成。</li>
</ul>
<h3 id="1-2-异步编程"><a href="#1-2-异步编程" class="headerlink" title="1.2 异步编程"></a>1.2 异步编程</h3><ul>
<li><strong>执行模型</strong>：异步编程允许任务在等待I&#x2F;O操作时挂起，释放线程去执行其他任务，完成后再恢复执行。</li>
<li><strong>优点</strong>：更高的性能，特别是在I&#x2F;O密集型应用中，因为可以更有效地利用资源。</li>
<li><strong>缺点</strong>：编程模型复杂，调试困难度较高。</li>
</ul>
<p>Python通过<code>asyncio</code>库为异步编程提供了强大的支持。</p>
<h2 id="二、Python异步编程基础"><a href="#二、Python异步编程基础" class="headerlink" title="二、Python异步编程基础"></a>二、Python异步编程基础</h2><h3 id="2-0-参考链接"><a href="#2-0-参考链接" class="headerlink" title="2.0 参考链接"></a>2.0 参考链接</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mrlonely2018/p/15998293.html" title="发布于 2022-03-12 20:25">学习python异步编程asyncio之协程和任务</a><br><a target="_blank" rel="noopener" href="https://github.com/hsz1273327/TutorialForPython/blob/master/%E8%AF%AD%E6%B3%95%E7%AF%87/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/%E9%98%BB%E5%A1%9E%E5%BC%82%E6%AD%A5%E4%B8%8E%E5%8D%8F%E7%A8%8B.ipynb">阻塞异步与协程.ipynb</a></p>
<h3 id="2-1-asyncio概述"><a href="#2-1-asyncio概述" class="headerlink" title="2.1 asyncio概述"></a>2.1 <code>asyncio</code>概述</h3><p><code>asyncio</code>是Python标准库中的一个库，旨在编写并发代码，特别是处理I&#x2F;O密集型和高层次结构化网络代码。它基于协程（coroutines）和事件循环（event loop）的概念。</p>
<h3 id="2-2-基本概念"><a href="#2-2-基本概念" class="headerlink" title="2.2 基本概念"></a>2.2 基本概念</h3><ul>
<li><strong>协程（Coroutine）</strong>：特殊的生成器，支持异步操作的函数，使用<code>async def</code>定义。</li>
<li><strong>事件循环（Event Loop）</strong>：协调和调度协程执行的核心机制。</li>
<li><strong>任务（Task）</strong>：包装协程的对象，用于追踪协程的执行状态。</li>
</ul>
<h3 id="2-3-简单示例"><a href="#2-3-简单示例" class="headerlink" title="2.3 简单示例"></a>2.3 简单示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_hello</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;World&quot;</span>)</span><br><span class="line"></span><br><span class="line">asyncio.run(say_hello())</span><br></pre></td></tr></table></figure>

<h2 id="三、异步转同步"><a href="#三、异步转同步" class="headerlink" title="三、异步转同步"></a>三、异步转同步</h2><p>在实际开发中，可能需要将异步代码转换为同步执行，特别是在与现有同步代码集成时。以下是几种常用的方法。</p>
<h3 id="3-0-参考链接"><a href="#3-0-参考链接" class="headerlink" title="3.0 参考链接"></a>3.0 参考链接</h3><p><a target="_blank" rel="noopener" href="https://github.com/rotationalio/pyensign/blob/c745da6dbb6a3999dbedb39ce4d3524bac56f4c0/pyensign/sync.py#L8">一份其他库里异步转同步的案例</a></p>
<h3 id="3-1-使用-asyncio-run"><a href="#3-1-使用-asyncio-run" class="headerlink" title="3.1 使用 asyncio.run"></a>3.1 使用 <code>asyncio.run</code></h3><p><code>asyncio.run</code> 是一种简单的方法，用于运行一个<strong>顶层</strong>的异步函数，并等待其完成。这适用于将异步代码作为脚本顶层入口执行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;End&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同步调用</span></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p><strong>注意事项</strong>：</p>
<ul>
<li><code>asyncio.run</code> 会创建并管理一个新的事件循环。</li>
<li>只能在主线程中调用，且不能在已有事件循环的环境中使用（例如，在Jupyter Notebook中可能会报错）。</li>
</ul>
<h3 id="3-2-使用事件循环的-run-until-complete"><a href="#3-2-使用事件循环的-run-until-complete" class="headerlink" title="3.2 使用事件循环的 run_until_complete"></a>3.2 使用事件循环的 <code>run_until_complete</code></h3><p>适用于需要更细粒度控制事件循环的场景。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;End&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取事件循环</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line"><span class="comment"># 运行直到完成</span></span><br><span class="line">loop.run_until_complete(main())</span><br></pre></td></tr></table></figure>

<p><strong>注意事项</strong>：</p>
<ul>
<li>在旧版本的Python（3.6及以下）中更常用。</li>
<li>在Python 3.7及以上，推荐使用<code>asyncio.run</code>。</li>
<li>可能需要手动管理事件循环的关闭。</li>
<li>若当前线程已存在事件循环（非运行状态），推荐使用本方法。</li>
</ul>
<h3 id="3-3-在现有同步线程中运行异步协程：run-coroutine-threadsafe"><a href="#3-3-在现有同步线程中运行异步协程：run-coroutine-threadsafe" class="headerlink" title="3.3 在现有同步线程中运行异步协程：run_coroutine_threadsafe"></a>3.3 在现有同步线程中运行异步协程：<code>run_coroutine_threadsafe</code></h3><p><code>run_coroutine_threadsafe</code> 是 <code>asyncio</code> 提供的方法，用于在已有事件循环的线程中，将协程提交给事件循环执行，并返回一个<code>concurrent.futures.Future</code>实例，可以用于等待协程的结果。</p>
<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><ul>
<li>将异步代码嵌入到多线程或多进程的同步代码中。</li>
<li>在GUI应用（如Tkinter、PyQt）中调用异步代码，同时保持界面响应。</li>
</ul>
<h4 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> concurrent.futures</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_task</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_async_in_sync</span>(<span class="params">x, y</span>):</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> loop.is_running():</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;Event loop is not running&quot;</span>)</span><br><span class="line">    future = asyncio.run_coroutine_threadsafe(async_task(x, y), loop)</span><br><span class="line">    <span class="keyword">return</span> future.result()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在主线程中启动事件循环</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_event_loop</span>(<span class="params">loop</span>):</span><br><span class="line">    asyncio.set_event_loop(loop)</span><br><span class="line">    loop.run_forever()</span><br><span class="line"></span><br><span class="line">new_loop = asyncio.new_event_loop()</span><br><span class="line">t = threading.Thread(target=start_event_loop, args=(new_loop,), daemon=<span class="literal">True</span>)</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在不同的线程中调用异步代码</span></span><br><span class="line">result = run_async_in_sync(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭事件循环</span></span><br><span class="line">new_loop.call_soon_threadsafe(new_loop.stop)</span><br><span class="line">t.join()</span><br><span class="line">new_loop.close() <span class="comment"># 这句不写貌似也可以，毕竟在单独的线程里，关不关都不妨碍主线程</span></span><br></pre></td></tr></table></figure>

<p><strong>解释</strong>：</p>
<ol>
<li>创建一个新的事件循环，并在单独的线程中运行它。</li>
<li>使用<code>asyncio.run_coroutine_threadsafe</code>将异步协程提交给事件循环执行。</li>
<li>使用<code>future.result()</code>等待并获取协程的结果。</li>
</ol>
<p><strong>注意事项</strong>：</p>
<ul>
<li>确保事件循环在单独的线程中持续运行，避免阻塞主线程。</li>
<li><strong>需要适当管理事件循环的启动和关闭</strong>，防止资源泄漏。<ul>
<li>这是一个比较难处理的问题，尤其在异步生成器转换时，下文会细说</li>
</ul>
</li>
</ul>
<h3 id="3-4-在现有事件循环中运行协程：nest-asyncio"><a href="#3-4-在现有事件循环中运行协程：nest-asyncio" class="headerlink" title="3.4 在现有事件循环中运行协程：nest_asyncio"></a>3.4 在现有事件循环中运行协程：<code>nest_asyncio</code></h3><blockquote>
<p>实践最好用这个</p>
</blockquote>
<p>有时在已有事件循环（如Jupyter Notebook）中需要运行协程，可以使用第三方库<code>nest_asyncio</code>来嵌套事件循环。</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install nest_asyncio</span><br></pre></td></tr></table></figure>

<h4 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> nest_asyncio</span><br><span class="line"></span><br><span class="line">nest_asyncio.apply()</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;End&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同步调用</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">loop.run_until_complete(main())</span><br></pre></td></tr></table></figure>

<p><strong>注意事项</strong>：</p>
<ul>
<li><code>nest_asyncio</code> 允许在已运行的事件循环中嵌套执行协程，适用于特殊的环境（例如web服务器、GUI或jupyternotebook等）。</li>
<li>不是所有场景下都适用，需谨慎使用。</li>
</ul>
<h2 id="四、异步生成器-async-gen-转换为同步"><a href="#四、异步生成器-async-gen-转换为同步" class="headerlink" title="四、异步生成器 (async_gen) 转换为同步"></a>四、异步生成器 (<code>async_gen</code>) 转换为同步</h2><p>异步生成器允许以异步的方式逐步产生数据。将异步生成器转换为同步代码，通常需要同步地迭代异步生成器。</p>
<h3 id="4-0-参考链接"><a href="#4-0-参考链接" class="headerlink" title="4.0 参考链接"></a>4.0 参考链接</h3><p><a target="_blank" rel="noopener" href="https://github.com/hikariatama/hikka-pyro/blob/f6e15767a4944ccb2acf04e21b9b046ff1fcf471/hikkapyro/sync.py#L36">一份他人实现方案</a><br><a target="_blank" rel="noopener" href="https://github.com/ydb-platform/ydb/blob/5b45c7497248b94d579ecaf8c43cdb997e1e66c0/contrib/python/grpcio/py3/grpc/_cython/_cygrpc/aio/common.pyx.pxi#L125">不知道是啥语言的神秘疑似伪代码但可以使用</a></p>
<h3 id="4-1-异步生成器示例"><a href="#4-1-异步生成器示例" class="headerlink" title="4.1 异步生成器示例"></a>4.1 异步生成器示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_gen</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">yield</span> i</span><br></pre></td></tr></table></figure>

<h3 id="4-2-同步迭代异步生成器"><a href="#4-2-同步迭代异步生成器" class="headerlink" title="4.2 同步迭代异步生成器"></a>4.2 同步迭代异步生成器</h3><p>要在同步代码中迭代异步生成器，可以采用以下方法：</p>
<h4 id="方法一：使用事件循环和-anext"><a href="#方法一：使用事件循环和-anext" class="headerlink" title="方法一：使用事件循环和 __anext__"></a>方法一：使用事件循环和 <code>__anext__</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_gen</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">async_gen_to_sync</span>(<span class="params">agen</span>):</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            next_coroutine = agen.__anext__()</span><br><span class="line">            value = loop.run_until_complete(next_coroutine)</span><br><span class="line">            <span class="keyword">yield</span> value</span><br><span class="line">        <span class="keyword">except</span> StopAsyncIteration:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> async_gen_to_sync(async_gen()):</span><br><span class="line">	<span class="built_in">print</span>(v)</span><br></pre></td></tr></table></figure>

<p>还有一种写法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sync_iter_async_gen</span>(<span class="params">agen</span>):</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">for</span> value <span class="keyword">in</span> <span class="built_in">iter</span>(<span class="keyword">lambda</span>: loop.run_until_complete(agen.__anext__()), <span class="literal">None</span>):</span><br><span class="line">		<span class="keyword">yield</span> value</span><br><span class="line">	<span class="keyword">except</span> StopAsyncIteration:</span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>容易发现，二者实质上是等价的。</p>
<p><strong>注意事项</strong>：</p>
<ul>
<li>此方法会在每次迭代时阻塞等待协程完成。</li>
<li>需要事件循环处于非运行状态，否则会引发错误。</li>
</ul>
<h4 id="方法二：使用-run-coroutine-threadsafe-在独立线程中运行"><a href="#方法二：使用-run-coroutine-threadsafe-在独立线程中运行" class="headerlink" title="方法二：使用 run_coroutine_threadsafe 在独立线程中运行"></a>方法二：使用 <code>run_coroutine_threadsafe</code> 在独立线程中运行</h4><p>这个要详细说一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_gen</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">async_gen_to_sync</span>(<span class="params">agen</span>):</span><br><span class="line">	loop = asyncio.new_event_loop()</span><br><span class="line">	t = threading.Thread(target=loop.run_forever)</span><br><span class="line">	t.start()</span><br><span class="line">	asyncio.set_event_loop(loop)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">for</span> value <span class="keyword">in</span> <span class="built_in">iter</span>(<span class="keyword">lambda</span>: asyncio.run_coroutine_threadsafe(agen.__anext__(), loop).result(), <span class="literal">None</span>):</span><br><span class="line">			<span class="keyword">yield</span> value</span><br><span class="line">	<span class="keyword">except</span> StopAsyncIteration:</span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line">	<span class="keyword">finally</span>:</span><br><span class="line">		loop.call_soon_threadsafe(loop.stop)</span><br><span class="line">		t.join()</span><br></pre></td></tr></table></figure>

<p><strong>解释</strong>：</p>
<ul>
<li>在独立的线程中启动事件循环，并运行异步生成器的消费协程。</li>
<li>主线程和事件循环线程互不干扰。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>不会阻塞主线程。</li>
<li>适用于需要并行处理的场景。</li>
</ul>
<p>隐藏问题：</p>
<ul>
<li>敏感的朋友很容易注意到，如果外部调用手动或意外中止，那么这个生成器无法获知这一点，依旧在自己单独线程里的<code>event_loop</code>中等待下一轮<code>yield</code>，也就是说只有手动<code>gen.close()</code>（等于在<code>try-except</code>语法中触发一个<code>GeneratorExit</code>错误，使函数运行到<code>finally</code>）或<code>stream finished</code>（整个生成器全部调用完，触发<code>StopAsyncIteration</code>）才能安全关掉<code>event_loop</code>。</li>
<li>这个感觉设计上没有更好的办法可以解决了，只能说用户自己用的时候多注意吧</li>
</ul>
<h4 id="方法三：收集所有生成的数据"><a href="#方法三：收集所有生成的数据" class="headerlink" title="方法三：收集所有生成的数据"></a>方法三：收集所有生成的数据</h4><p>如果异步生成器的数据量较小，可以将其全部收集到一个列表中，然后在同步代码中使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_gen</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">collect_async_gen</span>():</span><br><span class="line">    <span class="keyword">return</span> [item <span class="keyword">async</span> <span class="keyword">for</span> item <span class="keyword">in</span> async_gen()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sync_collect</span>():</span><br><span class="line">    <span class="keyword">return</span> asyncio.run(collect_async_gen())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line">results = sync_collect()</span><br><span class="line"><span class="built_in">print</span>(results)</span><br></pre></td></tr></table></figure>

<p><strong>注意事项</strong>：</p>
<ul>
<li>适用于数据量较小的生成器，避免大量数据占用内存。</li>
<li>无法逐步处理数据，需等待所有数据生成完成。</li>
</ul>
<h2 id="五、注意事项与最佳实践"><a href="#五、注意事项与最佳实践" class="headerlink" title="五、注意事项与最佳实践"></a>五、注意事项与最佳实践</h2><ol>
<li><p><strong>事件循环的管理</strong>：</p>
<ul>
<li>确保事件循环的创建、运行和关闭正确管理，避免资源泄漏或阻塞。</li>
<li>避免在同一个线程中重复创建事件循环。</li>
</ul>
</li>
<li><p><strong>线程安全</strong>：</p>
<ul>
<li><code>run_coroutine_threadsafe</code> 是线程安全的，但需要确保事件循环在另一个线程中运行。</li>
<li>避免在事件循环运行时阻塞事件循环线程。</li>
</ul>
</li>
<li><p><strong>异常处理</strong>：</p>
<ul>
<li>异步转同步时，需要适当捕获和处理异常，避免程序崩溃。</li>
<li>例如，使用<code>future.result()</code> 时，可能会引发协程中的异常。</li>
</ul>
</li>
<li><p><strong>性能考虑</strong>：</p>
<ul>
<li>将异步代码转换为同步代码可能会带来性能损失，尤其是在高频调用的场景。</li>
<li>尽量在需要时进行转换，避免频繁的上下文切换。</li>
</ul>
</li>
<li><p><strong>代码维护</strong>：</p>
<ul>
<li>保持异步与同步代码的清晰分离，避免混淆。</li>
<li>使用明确的接口和抽象层来管理异步与同步的交互。</li>
</ul>
</li>
</ol>
<h2 id="中插：一些额外的设计思考"><a href="#中插：一些额外的设计思考" class="headerlink" title="中插：一些额外的设计思考"></a>中插：一些额外的设计思考</h2><p>第五章中提到“保持异步与同步代码清晰分离，避免混淆”，这一点的确很重要，而异步转同步的操作本身即是违背了这一点的，这让人不禁想，一个良好的架构应当是如此混用的吗？</p>
<p>尤其是<code>run_coroutine_threadsafe</code>方法的使用场景，它几乎是为“异步调同步调异步”这样一个诡异的场景设计的，这是一个有必要的场景吗？用同步方法桥接两个异步方法？？</p>
<p>实际上，copy一份一模一样的同步方法，然后在其前面加个<code>async</code>，不就可以直接在该方法里<code>await</code>需要的异步方法了吗（即异步调异步调异步）？</p>
<p>我能想到的唯一有一定必要的场景就是“异步调同步…(同步*n)…调异步”，那么在不想为了一份async而copy+rewrite整条链路的情况下，确实需要使用<code>run_coroutine_threadsafe</code>，但这应当也是一个临时的处理方式，最健康的还是异步同步分离，最多进行一次转换。</p>
<p>当然<code>run_coroutine_threadsafe</code>其实也还好，当场转同步当场<code>loop.stop</code>还是挺安全的，只是切换上下文会有性能损失；十分不优雅的目前看只有类似生成器这种无法当场阻塞完的情况……</p>
<h2 id="六、完整示例"><a href="#六、完整示例" class="headerlink" title="六、完整示例"></a>六、完整示例</h2><p>以下是一个综合示例，展示了如何在同步代码中调用异步函数、处理异步生成器，以及使用<code>run_coroutine_threadsafe</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> concurrent.futures</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义异步任务</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fetch_data</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义异步生成器</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_gen</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在独立线程中运行事件循环</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_event_loop</span>(<span class="params">loop</span>):</span><br><span class="line">    asyncio.set_event_loop(loop)</span><br><span class="line">    loop.run_forever()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并启动事件循环线程</span></span><br><span class="line">new_loop = asyncio.new_event_loop()</span><br><span class="line">t = threading.Thread(target=start_event_loop, args=(new_loop,), daemon=<span class="literal">True</span>)</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 run_coroutine_threadsafe 调用异步函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data_sync</span>(<span class="params">x</span>):</span><br><span class="line">    future = asyncio.run_coroutine_threadsafe(fetch_data(x), new_loop)</span><br><span class="line">    <span class="keyword">return</span> future.result()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同步调用异步生成器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">async_gen_to_sync</span>(<span class="params">agen</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            future = asyncio.run_coroutine_threadsafe(agen.__anext__(), new_loop)</span><br><span class="line">            value = future.result()</span><br><span class="line">            <span class="keyword">yield</span> value</span><br><span class="line">        <span class="keyword">except</span> concurrent.futures.TimeoutError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Timeout occurred&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> StopAsyncIteration:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    result = get_data_sync(<span class="number">10</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;fetch_data result: <span class="subst">&#123;result&#125;</span>&quot;</span>)  <span class="comment"># 输出: fetch_data result: 20</span></span><br><span class="line"></span><br><span class="line">    gen_results = sync_iter_async_gen(async_gen())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;async_gen results: <span class="subst">&#123;gen_results&#125;</span>&quot;</span>)  <span class="comment"># 输出: async_gen results: [0, 1, 2]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭事件循环</span></span><br><span class="line">    new_loop.call_soon_threadsafe(new_loop.stop)</span><br><span class="line">    t.join()</span><br><span class="line">    new_loop.close()</span><br></pre></td></tr></table></figure>

<p><strong>输出</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fetch_data result: 20</span><br><span class="line">async_gen results: [0, 1, 2]</span><br></pre></td></tr></table></figure>

<p><strong>解释</strong>：</p>
<ol>
<li>创建一个新的事件循环，并在独立线程中运行它。</li>
<li>使用<code>run_coroutine_threadsafe</code>同步调用异步函数<code>fetch_data</code>。</li>
<li>通过<code>sync_iter_async_gen</code>函数同步迭代异步生成器<code>async_gen</code>。</li>
<li>最后，正确关闭事件循环和相关线程。</li>
</ol>
<h2 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h2><p>将异步代码转换为同步代码在Python开发中是一个常见需求，特别是在需要与现有同步系统集成时。通过理解<code>asyncio</code>的基本机制以及合理使用<code>run_coroutine_threadsafe</code>等方法，可以实现高效且可靠的异步转同步。处理异步生成器时，需要仔细管理事件循环和迭代过程，确保数据的正确获取和资源的有效利用。</p>
<p>在实践中，始终建议根据具体需求选择合适的方法，并注意避免常见的陷阱，如事件循环的冲突、线程安全问题等。通过良好的设计和充分的测试，可以有效地在异步和同步编程之间转换，实现功能强大且高效的Python应用。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/11/20/coding/2024-11-20-Python-asyncio%E5%BC%82%E6%AD%A5%E8%BD%AC%E5%90%8C%E6%AD%A5/" data-id="cmfp6md4r000usi2bg9lk7bj3" data-title="Python-asyncio异步转同步" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5-%E5%8D%8F%E7%A8%8B/" rel="tag">异步&#x2F;协程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E7%A8%8B/" rel="tag">线程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-pool/2024-11-05-git core.autocrlf配置说明" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/11/05/pool/2024-11-05-git%20core.autocrlf%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/" class="article-date">
  <time class="dt-published" datetime="2024-11-05T07:39:32.000Z" itemprop="datePublished">2024-11-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/engineering/">engineering</a>►<a class="article-category-link" href="/categories/engineering/git/">git</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/11/05/pool/2024-11-05-git%20core.autocrlf%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/">git core.autocrlf配置说明</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="转自"><a href="#转自" class="headerlink" title="转自"></a>转自</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/youpeng/p/11243871.html">git core.autocrlf配置说明 - Youpeng - 博客园</a></p>
<h3 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h3><p>格式化是许多开发人员在协作时，特别是在跨平台情况下，遇到的令人头疼的细小问题。 由于编辑器的不同或者Windows程序员在跨平台项目中的文件行尾加入了回车换行符， 一些细微的空格变化会不经意地进入大家合作的工作或提交的补丁中。不用怕，Git的一些配置选项会帮助你解决这些问题。</p>
<h3 id="core-autocrlf"><a href="#core-autocrlf" class="headerlink" title="core.autocrlf"></a>core.autocrlf</h3><p>假如你正在Windows上写程序，又或者你正在和其他人合作，他们在Windows上编程，而你却在其他系统上，在这些情况下，你可能会遇到行尾 结束符问题。 这是因为Windows使用回车和换行两个字符来结束一行，而Mac和Linux只使用换行一个字符。 虽然这是小问题，但它会极大地扰乱跨平台协作。</p>
<p>在Windows平台上，git默认的core.autocrlf是true，可以通过<code>git config --list</code>命令查看。</p>
<p>Git可以在你提交时自动地把行结束符CRLF转换成LF，而在签出代码时把LF转换成CRLF。用<code>core.autocrlf</code>来打开此项功能， 如果是在Windows系统上，把它设置成<code>true</code>（默认配置），这样当签出代码时，LF会被转换成CRLF：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --<span class="keyword">global</span> core.autocrlf <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>Linux或Mac系统使用LF作为行结束符，因此你不想Git在签出文件时进行自动的转换；当一个以CRLF为行结束符的文件不小心被引入时你肯定想进行修正， 把<code>core.autocrlf</code>设置成input来告诉Git在提交时把CRLF转换成LF，签出时不转换：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">config</span> --<span class="keyword">global</span> core<span class="variable">.autocrlf</span> <span class="keyword">input</span></span><br></pre></td></tr></table></figure>

<p>这样会在Windows系统上的签出文件中保留CRLF，会在Mac和Linux系统上，包括仓库中保留LF。</p>
<p>如果你是Windows程序员，且正在开发仅运行在Windows上的项目，可以设置<code>false</code>取消此功能，把回车符记录在库中：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --<span class="keyword">global</span> core.autocrlf <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>关于在IDEA中的提示，如下图所示，点击<code>FIX AND COMMIT</code>即可。<br><img src="https://img2018.cnblogs.com/blog/1577027/201907/1577027-20190725140322466-21269825.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/11/05/pool/2024-11-05-git%20core.autocrlf%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/" data-id="cmfp6md5s004gsi2bdx9i4dfp" data-title="git core.autocrlf配置说明" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-engineering/2024-10-24-WSL启用参考与踩雷" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/24/engineering/2024-10-24-WSL%E5%90%AF%E7%94%A8%E5%8F%82%E8%80%83%E4%B8%8E%E8%B8%A9%E9%9B%B7/" class="article-date">
  <time class="dt-published" datetime="2024-10-24T07:57:34.000Z" itemprop="datePublished">2024-10-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/engineering/">engineering</a>►<a class="article-category-link" href="/categories/engineering/environment/">environment</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/24/engineering/2024-10-24-WSL%E5%90%AF%E7%94%A8%E5%8F%82%E8%80%83%E4%B8%8E%E8%B8%A9%E9%9B%B7/">WSL启用参考与踩雷</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/answers/questions/1347969/win11-wsl">win11 自带的wsl打开异常</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows/wsl/install">如何使用 WSL 在 Windows 上安装 Linux</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows/wsl/setup/environment#set-up-your-linux-username-and-password">设置 WSL 开发环境</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package">旧版 WSL 的手动安装步骤</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-vscode?source=recommendations">开始通过适用于 Linux 的 Windows 子系统使用 Visual Studio Code</a></li>
</ul>
<h1 id="踩雷点"><a href="#踩雷点" class="headerlink" title="踩雷点"></a>踩雷点</h1><ol>
<li>WSL1 pip链接持续出错，可以Ping通可以curl，就是pip不上，换镜像换vpn都没用，升级成WSL2后自动好了</li>
<li>不知为何安装花了很长时间都没显示完成，自己把ubuntu窗口叉掉之后，完全正常运行，也没有设定账号密码，直接root账户，很怪</li>
<li>win10开不了镜像模式，即无法两边互通，不想乱动宿主机防火墙的情况下只能宿主机单向通wsl</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/24/engineering/2024-10-24-WSL%E5%90%AF%E7%94%A8%E5%8F%82%E8%80%83%E4%B8%8E%E8%B8%A9%E9%9B%B7/" data-id="cmfp6md5g0036si2bacf76pth" data-title="WSL启用参考与踩雷" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/win/" rel="tag">win</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-language/2024-10-24-A2-English-for-Developers-one" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/24/language/2024-10-24-A2-English-for-Developers-one/" class="article-date">
  <time class="dt-published" datetime="2024-10-24T05:59:44.000Z" itemprop="datePublished">2024-10-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/language/">language</a>►<a class="article-category-link" href="/categories/language/english/">english</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/24/language/2024-10-24-A2-English-for-Developers-one/">A2-English-for-Developers-one</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="dialogue-text"><a href="#dialogue-text" class="headerlink" title="dialogue text"></a>dialogue text</h1><p>M:<br>Hello! You’re the new graphic designer, right? I’m Maria, the team lead.<br>T:<br>Hi, that’s right! I’m Tom McKenzie. It’s a pleasure to meet you.<br>M:<br>Welcome aboard, Tom! How do you like California so far?<br>T:<br>I like it. It’s different from Texas, but I like it here.<br>M:<br>Great! Let me show you to your desk.<br>Do you see the desk with a drawing tablet and a computer?<br>That’s your workspace.<br>T:<br>Everything looks great,<br>Thanks for showing me around the place, Maria.</p>
<h1 id="task"><a href="#task" class="headerlink" title="task"></a>task</h1><h2 id="task-1-contractions"><a href="#task-1-contractions" class="headerlink" title="task 1 contractions"></a>task 1 <em>contractions</em></h2><p>contractions are commonly used to make speech sound more natural and fluent.<br><strong>belike “you’re”</strong></p>
<h2 id="task-2-tag-questions"><a href="#task-2-tag-questions" class="headerlink" title="task 2 tag questions"></a>task 2 <em>tag questions</em></h2><p>to check or confirm something people sometimes use tag questions.<br><strong>belike “you’re a programent, right?”</strong></p>
<h2 id="task-3-mention-what"><a href="#task-3-mention-what" class="headerlink" title="task 3 mention what"></a>task 3 <em>mention what</em></h2><p>we often mention our job or role in a company by saying.<br><strong>belike “I’m [name], the [job title]”</strong></p>
<ul>
<li>occupation</li>
</ul>
<h2 id="task-4-team-lead"><a href="#task-4-team-lead" class="headerlink" title="task 4 team lead"></a>task 4 <em>team lead</em></h2><p>a leadership role</p>
<ul>
<li>dialogue</li>
<li>introduces</li>
</ul>
<h2 id="task-5-confirm-someone-assumption"><a href="#task-5-confirm-someone-assumption" class="headerlink" title="task 5 confirm someone assumption"></a>task 5 <em>confirm someone assumption</em></h2><p>When someone makes a correct assumption or guess about you, you can confirm it using phrases like <code>that&#39;s right</code></p>
<h2 id="task-7-to-be"><a href="#task-7-to-be" class="headerlink" title="task 7 to be"></a>task 7 <em>to be</em></h2><p>the verb <code>to be</code> is used to talk about identities, characteristics, and more.</p>
<h2 id="task-8-task-1-contractions"><a href="#task-8-task-1-contractions" class="headerlink" title="task 8 [[#task 1 contractions]]"></a>task 8 [[#task 1 <em>contractions</em>]]</h2><p>Contractions are a way to shorten common combinations of words, especially with verbs.</p>
<h2 id="task-9-formally-introduce"><a href="#task-9-formally-introduce" class="headerlink" title="task 9 formally introduce"></a>task 9 <em>formally introduce</em></h2><p>full name</p>
<h2 id="task-10-polite-greet"><a href="#task-10-polite-greet" class="headerlink" title="task 10 polite greet"></a>task 10 <em>polite greet</em></h2><p>Expressions like <code>It&#39;s a pleasure to meet you</code> are commonly used when meeting someone for the first time as a polite way to greet someone.</p>
<ul>
<li>indicate</li>
</ul>
<h2 id="task-11-welcome-aboard"><a href="#task-11-welcome-aboard" class="headerlink" title="task 11 welcome aboard"></a>task 11 <em>welcome aboard</em></h2><p>The expression <code>Welcome aboard</code> is used to greet someone who has just joined a group, team, or organization.</p>
<ul>
<li>the board of directors</li>
</ul>
<h2 id="task-12-ask-opinion"><a href="#task-12-ask-opinion" class="headerlink" title="task 12 ask opinion"></a>task 12 <em>ask opinion</em></h2><p>When you want to ask someone for their opinion or feelings about something, especially a place or an experience, you can use the phrase <code>How do you like</code>.</p>
<h2 id="task-13-so-far"><a href="#task-13-so-far" class="headerlink" title="task 13 so far"></a>task 13 <em>so far</em></h2><p>The phrase <code>so far</code> is used in English to indicate the time up to the present moment or up to a certain point.</p>
<ul>
<li>certain</li>
<li>impressions</li>
</ul>
<h2 id="task-14-task-13-so-far"><a href="#task-14-task-13-so-far" class="headerlink" title="task 14 [[#task 13 so far]]"></a>task 14 [[#task 13 <em>so far</em>]]</h2><ul>
<li>experience</li>
<li>appropriate</li>
</ul>
<h2 id="task-15-talk-about-preferences"><a href="#task-15-talk-about-preferences" class="headerlink" title="task 15 talk about preferences"></a>task 15 <em>talk about preferences</em></h2><p>When talking about preferences or feelings towards something, the phrase <code>I like it</code> is often used.</p>
<ul>
<li>positive</li>
<li>toward</li>
</ul>
<h2 id="task-16-comparing"><a href="#task-16-comparing" class="headerlink" title="task 16 comparing"></a>task 16 <em>comparing</em></h2><p>When you want to highlight differences between two things, you can use the phrase <code>different from</code>.</p>
<h2 id="task-17-task-16-comparing"><a href="#task-17-task-16-comparing" class="headerlink" title="task 17 [[#task 16 comparing]]"></a>task 17 [[#task 16 <em>comparing</em>]]</h2><ul>
<li>describe</li>
<li>the same as</li>
</ul>
<h2 id="task-19-It’s"><a href="#task-19-It’s" class="headerlink" title="task 19 It’s"></a>task 19 <em>It’s</em></h2><p>When talking about places or things, especially when comparing or describing them, <code>it&#39;s</code> serves as a subject and verb starter for the sentence.</p>
<ul>
<li>especially</li>
<li>subject</li>
<li>serves as</li>
</ul>
<h2 id="task-20-positive-feeling"><a href="#task-20-positive-feeling" class="headerlink" title="task 20 positive feeling"></a>task 20 <em>positive feeling</em></h2><p>When expressing a positive feeling about a place, one might use the phrase <code>I like it here</code>.</p>
<ul>
<li>statement</li>
<li>content</li>
<li>neutral</li>
</ul>
<h2 id="task-21-task-20-positive-feeling"><a href="#task-21-task-20-positive-feeling" class="headerlink" title="task 21 [[#task 20 positive feeling]]"></a>task 21 [[#task 20 <em>positive feeling</em>]]</h2><p>The phrase <code>I like it here</code> is commonly used to express positive feelings about a current location or environment. When someone says this, they are often commenting on their general comfort, happiness, or satisfaction with the place they are in.</p>
<ul>
<li>emphasizing</li>
<li>contentment</li>
<li>despite</li>
</ul>
<h2 id="task-22-guide-or-direct"><a href="#task-22-guide-or-direct" class="headerlink" title="task 22 guide or direct"></a>task 22 <em>guide or direct</em></h2><p>When someone wants to guide or direct another person somewhere, they can use <code>let me show you to your [place]</code>, <code>place</code> being the destination.</p>
<ul>
<li>destination</li>
</ul>
<h2 id="task-23-task-22-guide-or-direct"><a href="#task-23-task-22-guide-or-direct" class="headerlink" title="task 23 [[#task 22 guide or direct]]"></a>task 23 [[#task 22 <em>guide or direct</em>]]</h2><p>The phrase <code>let me show you</code> is an offer of assistance or guidance. It expresses the speaker’s intention to demonstrate or direct something to the listener.</p>
<ul>
<li>an offer of</li>
<li>assistance</li>
<li>guidance</li>
<li>intention</li>
<li>demonstrate</li>
</ul>
<h2 id="task-24-task-22-guide-or-direct"><a href="#task-24-task-22-guide-or-direct" class="headerlink" title="task 24 [[#task 22 guide or direct]]"></a>task 24 [[#task 22 <em>guide or direct</em>]]</h2><p>The phrase <code>let me show you</code> can be used to direct attention and introduce something.</p>
<ul>
<li>conference</li>
<li>direct</li>
</ul>
<h2 id="task-25-desk"><a href="#task-25-desk" class="headerlink" title="task 25 desk"></a>task 25 <em>desk</em></h2><p>A <code>desk</code> is often the central part of one’s workspace, especially in an office setting. People typically use it to set up their computers, write, read, and do other work-related tasks.</p>
<ul>
<li>organize</li>
<li>tidy</li>
</ul>
<h2 id="task-26-drawing-tablet"><a href="#task-26-drawing-tablet" class="headerlink" title="task 26 drawing tablet"></a>task 26 <em>drawing tablet</em></h2><p>A drawing tablet is a tool that people use with computers to draw or design things.</p>
<h2 id="task-28-describing"><a href="#task-28-describing" class="headerlink" title="task 28 describing"></a>task 28 <em>describing</em></h2><p>Describing objects or places with their characteristics or things related to them helps the listener to identify them easily.</p>
<ul>
<li>characteristics</li>
</ul>
<h2 id="task-29-workspace"><a href="#task-29-workspace" class="headerlink" title="task 29 workspace"></a>task 29 <em>workspace</em></h2><p>The term <code>workspace</code> is often used to describe the area where someone works, especially in an office environment.</p>
<h2 id="task-30-task-20-positive-feeling"><a href="#task-30-task-20-positive-feeling" class="headerlink" title="task 30 [[#task 20 positive feeling]]"></a>task 30 [[#task 20 <em>positive feeling</em>]]</h2><p>Expressing satisfaction or contentment in English can be done using various expressions. <code>Everything looks great</code> is one way to show that you are pleased or satisfied with something.</p>
<ul>
<li>various</li>
</ul>
<h2 id="task-31-gratitude"><a href="#task-31-gratitude" class="headerlink" title="task 31 gratitude"></a>task 31 <em>gratitude</em></h2><p>Expressing gratitude is common in the workplace, especially when someone helps you. </p>
<ul>
<li>specific</li>
</ul>
<h2 id="task-32-task-31-gratitude"><a href="#task-32-task-31-gratitude" class="headerlink" title="task 32 [[#task 31 gratitude]]"></a>task 32 [[#task 31 <em>gratitude</em>]]</h2><p>When expressing gratitude, we sometimes mention the action for which we are thankful.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/24/language/2024-10-24-A2-English-for-Developers-one/" data-id="cmfp6md5j003isi2b6ojm569d" data-title="A2-English-for-Developers-one" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/A2E4D/" rel="tag">A2E4D</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-engineering/2024-10-24-ssh-keygen自定义密钥名称" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/24/engineering/2024-10-24-ssh-keygen%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%86%E9%92%A5%E5%90%8D%E7%A7%B0/" class="article-date">
  <time class="dt-published" datetime="2024-10-24T02:50:11.000Z" itemprop="datePublished">2024-10-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/engineering/">engineering</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/24/engineering/2024-10-24-ssh-keygen%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%86%E9%92%A5%E5%90%8D%E7%A7%B0/">ssh-keygen自定义密钥名称</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>是的，使用 <code>ssh-keygen</code> 生成 SSH 密钥时，你可以自定义生成的私钥和公钥的名称。</p>
<h3 id="自定义密钥名称的步骤"><a href="#自定义密钥名称的步骤" class="headerlink" title="自定义密钥名称的步骤"></a>自定义密钥名称的步骤</h3><p>在运行 <code>ssh-keygen</code> 时，可以使用 <code>-f</code> 选项来指定密钥的文件名。</p>
<p>以下是一个示例命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;your_email@example.com&quot;</span> -f ~/.ssh/custom_key_name</span><br></pre></td></tr></table></figure>

<h3 id="解释命令参数："><a href="#解释命令参数：" class="headerlink" title="解释命令参数："></a>解释命令参数：</h3><ul>
<li><code>-t rsa</code>：指定密钥类型为 RSA。</li>
<li><code>-C &quot;your_email@example.com&quot;</code>：添加备注或标签，通常使用你的邮箱，以便在密钥标识中清楚区分。</li>
<li><code>-f ~/.ssh/custom_key_name</code>：指定密钥文件的名称和路径。在这个例子中，将生成 <code>~/.ssh/custom_key_name</code>（私钥）和 <code>~/.ssh/custom_key_name.pub</code>（公钥）。</li>
</ul>
<h3 id="生成密钥之后的步骤"><a href="#生成密钥之后的步骤" class="headerlink" title="生成密钥之后的步骤"></a>生成密钥之后的步骤</h3><p>生成密钥后，你会在指定的位置找到生成的私钥和公钥文件。确保私钥文件的权限设置为只有用户可读（例如，使用 <code>chmod 600</code>）。</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>以下是完整的示例流程：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;your_email@example.com&quot;</span> -f ~/.ssh/my_custom_key</span><br></pre></td></tr></table></figure>

<p>然后，私钥文件为 <code>~/.ssh/my_custom_key</code>，公钥文件为 <code>~/.ssh/my_custom_key.pub</code>。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>通过使用 <code>-f</code> 选项，你可以自定义 SSH 密钥的名称。生成后，请妥善管理和保护你的私钥。如果有任何其他问题，请随时问我！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/24/engineering/2024-10-24-ssh-keygen%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%86%E9%92%A5%E5%90%8D%E7%A7%B0/" data-id="cmfp6md5h003asi2b5b16acse" data-title="ssh-keygen自定义密钥名称" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-pool/2024-10-18-日记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/18/pool/2024-10-18-%E6%97%A5%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2024-10-18T08:41:03.000Z" itemprop="datePublished">2024-10-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/diary/">diary</a>►<a class="article-category-link" href="/categories/diary/24%E5%B9%B4/">24年</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/18/pool/2024-10-18-%E6%97%A5%E8%AE%B0/">日记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>今天同时探索了中文版斯坦福小镇和flowise，都是闲着没事搜as发现的。</p>
<p>flowise是油管下评论看到的</p>
<p>这两个都是node.js相关</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/18/pool/2024-10-18-%E6%97%A5%E8%AE%B0/" data-id="cmfp6md5r004dsi2b2rjx9ohh" data-title="日记" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-debug/2024-10-18-不太安全但管用的docker非root用户权限问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/18/debug/2024-10-18-%E4%B8%8D%E5%A4%AA%E5%AE%89%E5%85%A8%E4%BD%86%E7%AE%A1%E7%94%A8%E7%9A%84docker%E9%9D%9Eroot%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2024-10-18T07:21:13.000Z" itemprop="datePublished">2024-10-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/debug/">debug</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/18/debug/2024-10-18-%E4%B8%8D%E5%A4%AA%E5%AE%89%E5%85%A8%E4%BD%86%E7%AE%A1%E7%94%A8%E7%9A%84docker%E9%9D%9Eroot%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/">不太安全但管用的docker非root用户权限问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 666 /var/run/docker.sock</span><br></pre></td></tr></table></figure>

<p>比较粗暴但是省时间。</p>
<p>我个人认为调整docker组也可以，而且更可控。但~whatever，简单就可以</p>
<p><a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/questions/how-to-fix-docker-got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket">参考链接</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/linux-postinstall/">官网解决方案</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/18/debug/2024-10-18-%E4%B8%8D%E5%A4%AA%E5%AE%89%E5%85%A8%E4%BD%86%E7%AE%A1%E7%94%A8%E7%9A%84docker%E9%9D%9Eroot%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/" data-id="cmfp6md4z001bsi2bhx0uauq8" data-title="不太安全但管用的docker非root用户权限问题" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/environment/" rel="tag">environment</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-coding/2024-10-18-npm_Node.js探秘" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/18/coding/2024-10-18-npm_Node.js%E6%8E%A2%E7%A7%98/" class="article-date">
  <time class="dt-published" datetime="2024-10-18T05:56:00.000Z" itemprop="datePublished">2024-10-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/coding/">coding</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/18/coding/2024-10-18-npm_Node.js%E6%8E%A2%E7%A7%98/">npm_Node.js探秘</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><code>npm</code> 是 Node.js 的包管理器，全称为 “Node Package Manager”。它是一个命令行工具，用于安装、管理和更新 Node.js 应用程序中的第三方库和依赖项。<code>npm</code> 也是世界上最大的软件注册表之一，包含了数以百万计的开源包。</p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><h3 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h3><ol>
<li><p><strong>安装包</strong>：</p>
<ul>
<li>使用 <code>npm install &lt;package-name&gt;</code> 命令可以安装指定的包及其依赖项。</li>
<li>例如：<code>npm install lodash</code> 会安装 <code>lodash</code> 包。</li>
</ul>
</li>
<li><p><strong>全局安装包</strong>：</p>
<ul>
<li>使用 <code>npm install -g &lt;package-name&gt;</code> 命令可以全局安装包，使其在系统任何地方都可用。</li>
<li>例如：<code>npm install -g typescript</code> 会全局安装 TypeScript 编译器。</li>
</ul>
</li>
<li><p><strong>卸载包</strong>：</p>
<ul>
<li>使用 <code>npm uninstall &lt;package-name&gt;</code> 命令可以卸载指定的包。</li>
<li>例如：<code>npm uninstall lodash</code> 会卸载 <code>lodash</code> 包。</li>
</ul>
</li>
<li><p><strong>更新包</strong>：</p>
<ul>
<li>使用 <code>npm update &lt;package-name&gt;</code> 命令可以更新指定的包到最新版本。</li>
<li>例如：<code>npm update lodash</code> 会将 <code>lodash</code> 更新到最新版本。</li>
</ul>
</li>
<li><p><strong>查看已安装的包</strong>：</p>
<ul>
<li>使用 <code>npm list</code> 命令可以查看当前项目中已安装的包及其依赖关系。</li>
<li>使用 <code>npm list -g</code> 命令可以查看全局安装的包。</li>
</ul>
</li>
<li><p><strong>初始化项目</strong>：</p>
<ul>
<li>使用 <code>npm init</code> 命令可以创建一个新的 <code>package.json</code> 文件，该文件用于管理项目的元数据和依赖项。</li>
<li>运行 <code>npm init</code> 会引导你完成一系列问题，生成 <code>package.json</code> 文件。</li>
</ul>
</li>
<li><p><strong>运行脚本</strong>：</p>
<ul>
<li>在 <code>package.json</code> 文件中定义的脚本可以通过 <code>npm run &lt;script-name&gt;</code> 命令运行。</li>
<li>例如，如果 <code>package.json</code> 中有一个名为 <code>start</code> 的脚本，可以使用 <code>npm run start</code> 来运行它。</li>
</ul>
</li>
</ol>
<h3 id="package-json-文件"><a href="#package-json-文件" class="headerlink" title="package.json 文件"></a><code>package.json</code> 文件</h3><p><code>package.json</code> 是一个 JSON 文件，位于项目的根目录下，用于存储项目的元数据和依赖信息。以下是 <code>package.json</code> 文件的基本结构：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-project&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A sample Node.js project&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mocha test/**/*.js&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;express&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.17.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lodash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.17.21&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;mocha&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^8.2.1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Your Name&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><ul>
<li><p><strong>安装所有依赖</strong>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装特定版本的包</strong>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install &lt;package-name&gt;@&lt;version&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装开发依赖</strong>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev &lt;package-name&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>查看包的信息</strong>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm info &lt;package-name&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>搜索包</strong>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm search &lt;query&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>npm</code> 是 Node.js 生态系统中不可或缺的一部分，它简化了包的管理和依赖项的处理，使得开发者可以更高效地构建和维护项目。希望这些信息对你理解 <code>npm</code> 有所帮助！如果你有任何具体的问题或需要进一步的指导，请告诉我。</p>
<h2 id="修改国内镜像源"><a href="#修改国内镜像源" class="headerlink" title="修改国内镜像源"></a>修改国内镜像源</h2><h3 id="一、修改成腾讯云镜像源"><a href="#一、修改成腾讯云镜像源" class="headerlink" title="一、修改成腾讯云镜像源"></a>一、修改成腾讯云镜像源</h3><p>1、命令</p>
<p>npm config set registry <a target="_blank" rel="noopener" href="http://mirrors.cloud.tencent.com/npm/">http://mirrors.cloud.tencent.com/npm/</a></p>
<ol start="2">
<li>验证命令</li>
</ol>
<p>npm config get registry</p>
<p>如果返回<a target="_blank" rel="noopener" href="http://mirrors.cloud.tencent.com/npm/%EF%BC%8C%E8%AF%B4%E6%98%8E%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F%E3%80%82">http://mirrors.cloud.tencent.com/npm/，说明镜像配置成功。</a></p>
<h3 id="二、修改成淘宝镜像源"><a href="#二、修改成淘宝镜像源" class="headerlink" title="二、修改成淘宝镜像源"></a>二、修改成淘宝镜像源</h3><ol>
<li>命令</li>
</ol>
<p>npm config set registry <a target="_blank" rel="noopener" href="https://registry.npmmirror.com/">https://registry.npmmirror.com</a></p>
<ol start="2">
<li>验证命令</li>
</ol>
<p>npm config get registry</p>
<p>如果返回<a target="_blank" rel="noopener" href="https://registry.npmmirror.com,说明镜像配置成功./">https://registry.npmmirror.com，说明镜像配置成功。</a></p>
<h3 id="三、修改成华为云镜像源"><a href="#三、修改成华为云镜像源" class="headerlink" title="三、修改成华为云镜像源"></a>三、修改成华为云镜像源</h3><ol>
<li>命令</li>
</ol>
<p>npm config set registry <a target="_blank" rel="noopener" href="https://mirrors.huaweicloud.com/repository/npm/">https://mirrors.huaweicloud.com/repository/npm/</a></p>
<ol start="2">
<li>验证命令</li>
</ol>
<p>npm config get registry</p>
<p>如果返回<a target="_blank" rel="noopener" href="https://mirrors.huaweicloud.com/repository/npm/%EF%BC%8C%E8%AF%B4%E6%98%8E%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F%E3%80%82">https://mirrors.huaweicloud.com/repository/npm/，说明镜像配置成功。</a></p>
<h3 id="四、通过使用淘宝定制的cnpm安装"><a href="#四、通过使用淘宝定制的cnpm安装" class="headerlink" title="四、通过使用淘宝定制的cnpm安装"></a>四、通过使用淘宝定制的cnpm安装</h3><ol>
<li>安装cnpm</li>
</ol>
<p>npm install -g cnpm –registry&#x3D;<a target="_blank" rel="noopener" href="https://registry.npmmirror.com/">https://registry.npmmirror.com</a></p>
<ol start="2">
<li>使用cnpm</li>
</ol>
<p>cnpm install xxx</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/18/coding/2024-10-18-npm_Node.js%E6%8E%A2%E7%A7%98/" data-id="cmfp6md4q000ssi2b4egu4f87" data-title="npm_Node.js探秘" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-pool/2024-10-18-Pinokio_AI浏览器调研" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/18/pool/2024-10-18-Pinokio_AI%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B0%83%E7%A0%94/" class="article-date">
  <time class="dt-published" datetime="2024-10-18T05:39:46.000Z" itemprop="datePublished">2024-10-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/18/pool/2024-10-18-Pinokio_AI%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B0%83%E7%A0%94/">Pinokio_AI浏览器调研</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/18/pool/2024-10-18-Pinokio_AI%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B0%83%E7%A0%94/" data-id="cmfp6md5q004bsi2b52v87xdu" data-title="Pinokio_AI浏览器调研" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-pool/2024-10-16-as-rag模块拓展思考" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/16/pool/2024-10-16-as-rag%E6%A8%A1%E5%9D%97%E6%8B%93%E5%B1%95%E6%80%9D%E8%80%83/" class="article-date">
  <time class="dt-published" datetime="2024-10-16T10:02:47.000Z" itemprop="datePublished">2024-10-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/16/pool/2024-10-16-as-rag%E6%A8%A1%E5%9D%97%E6%8B%93%E5%B1%95%E6%80%9D%E8%80%83/">as-rag模块拓展思考</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>一些问题：</p>
<p>Langchain选择使用index导入而不是直接从数据库导入，主要是为了在应用中提供灵活性和简便性。以下是原因分析：</p>
<ol>
<li><strong>本地化管理</strong>：通过index导入，可以在应用层级方便地管理和更新数据，而无需涉及数据库层的复杂操作。这使得开发者可以快速刷新或重建索引，适应动态变化的需求。</li>
<li><strong>一体化工作流</strong>：直接集成索引生成与使用，提升了开发体验，使得模型、数据预处理、索引管理一体化。无需额外的集成步骤。</li>
</ol>
<p>对于弊端：</p>
<ol>
<li><strong>初始数据集成问题</strong>：对于已有的向量数据没有现成索引的情况，确实需要重新创建或使用其他工具进行集成。这可能牺牲了一部分灵活性。</li>
<li><strong>工具限制</strong>：当前Langchain和LlamaIndex可能都不支持直接利用无需重新处理的已有存储向量。这是一个潜在的限制，需要开发者根据实际需求进行权衡或者扩展。</li>
</ol>
<p>解决方案的可能途径包括使用适配器或中间件，来桥接现有数据架构和Langchain的索引需求。这样可以在保留灵活性的同时，支持更广泛的使用场景。</p>
<p>关于llamaindex从向量存储加载数据：</p>
<p><a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/community/integrations/vector_stores/#loading-data-from-vector-stores-using-data-connector">https://docs.llamaindex.ai/en/stable/community/integrations/vector_stores&#x2F;#loading-data-from-vector-stores-using-data-connector</a></p>
<p>其实就是把原本的向量数据转换成documents，然后用同样的接口加载进index（注意此处并非vector index）。</p>
<p>langchain不支持这种操作，我一开始以为是因为它的add_documents没有判断doc中是否存在”vectors”的环节：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_documents</span>(<span class="params"></span></span><br><span class="line"><span class="params">    self,</span></span><br><span class="line"><span class="params">    documents: <span class="built_in">list</span>[Document],</span></span><br><span class="line"><span class="params">    ids: <span class="type">Optional</span>[<span class="built_in">list</span>[<span class="built_in">str</span>]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    **kwargs: <span class="type">Any</span>,</span></span><br><span class="line"><span class="params">    </span>) -&gt; <span class="built_in">list</span>[<span class="built_in">str</span>]:</span><br><span class="line"><span class="string">&quot;&quot;&quot;Add documents to the store.&quot;&quot;&quot;</span></span><br><span class="line">texts = [doc.page_content <span class="keyword">for</span> doc <span class="keyword">in</span> documents]</span><br><span class="line">vectors = <span class="variable language_">self</span>.embedding.embed_documents(texts)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ids <span class="keyword">and</span> <span class="built_in">len</span>(ids) != <span class="built_in">len</span>(texts):</span><br><span class="line">    msg = (</span><br><span class="line">        <span class="string">f&quot;ids must be the same length as texts. &quot;</span></span><br><span class="line">        <span class="string">f&quot;Got <span class="subst">&#123;<span class="built_in">len</span>(ids)&#125;</span> ids and <span class="subst">&#123;<span class="built_in">len</span>(texts)&#125;</span> texts.&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">raise</span> ValueError(msg)</span><br><span class="line"></span><br><span class="line">    id_iterator: Iterator[<span class="type">Optional</span>[<span class="built_in">str</span>]] = (</span><br><span class="line">        <span class="built_in">iter</span>(ids) <span class="keyword">if</span> ids <span class="keyword">else</span> <span class="built_in">iter</span>(doc.<span class="built_in">id</span> <span class="keyword">for</span> doc <span class="keyword">in</span> documents)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">ids_ = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> doc, vector <span class="keyword">in</span> <span class="built_in">zip</span>(documents, vectors):</span><br><span class="line">    doc_id = <span class="built_in">next</span>(id_iterator)</span><br><span class="line">    doc_id_ = doc_id <span class="keyword">if</span> doc_id <span class="keyword">else</span> <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line">    ids_.append(doc_id_)</span><br><span class="line">    <span class="variable language_">self</span>.store[doc_id_] = &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: doc_id_,</span><br><span class="line">        <span class="string">&quot;vector&quot;</span>: vector,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: doc.page_content,</span><br><span class="line">        <span class="string">&quot;metadata&quot;</span>: doc.metadata,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ids_</span><br></pre></td></tr></table></figure>

<p>其实langchain应该也是支持的，只不过传入index的存储库不能是add_documents中自动含有<code>self.embedding.embed_documents</code>这种向量转换的存储库，实际上llamaindex也是这个原理，使用别的方法加载，绕开向量转换的操作。</p>
<p>另，llamaindex的vectorstoreindex中，有一个方法专门用来直接加载向量存储库为index：<code>.from_vector_store</code>，</p>
<p>经验证是可以的。阅读源码，发现原理其实就是直接传入一个nodes空列表，也就是说这个方法并没有真正建立新的索引：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">from_vector_store</span>(<span class="params"></span></span><br><span class="line"><span class="params">    cls,</span></span><br><span class="line"><span class="params">    vector_store: BasePydanticVectorStore,</span></span><br><span class="line"><span class="params">    embed_model: <span class="type">Optional</span>[EmbedType] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    **kwargs: <span class="type">Any</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="string">&quot;VectorStoreIndex&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> vector_store.stores_text:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(</span><br><span class="line">            <span class="string">&quot;Cannot initialize from a vector store that does not store text.&quot;</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    kwargs.pop(<span class="string">&quot;storage_context&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    storage_context = StorageContext.from_defaults(vector_store=vector_store)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cls(</span><br><span class="line">        nodes=[],</span><br><span class="line">        embed_model=embed_model,</span><br><span class="line">        storage_context=storage_context,</span><br><span class="line">        **kwargs,</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<p>并且as中的实现也是必须基于index通过文档创建而非通过向量数据库创建（即必须自带源）</p>
<p>所以<del>没问题啦</del>！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/16/pool/2024-10-16-as-rag%E6%A8%A1%E5%9D%97%E6%8B%93%E5%B1%95%E6%80%9D%E8%80%83/" data-id="cmfp6md5q0048si2b1d7g4hmx" data-title="as-rag模块拓展思考" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/coding/">coding</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/debug/">debug</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/debug/coding/">coding</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/debug/linux/">linux</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/diary/">diary</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/diary/24%E5%B9%B4/">24年</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/">engineering</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/GPU/">GPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/LLM/">LLM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/environment/">environment</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/pool/">pool</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/win/">win</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/%E5%8A%A0%E9%80%9F/">加速</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/%E6%A8%A1%E5%9E%8B%E5%B7%A5%E7%A8%8B/">模型工程</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/environment/">environment</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">game</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/language/">language</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/language/english/">english</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A3%A8%E5%88%80/">磨刀</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A3%A8%E5%88%80/obsidian/">obsidian</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E8%80%83/">软考</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E8%80%83/%E5%85%AC%E5%85%B1%E8%AF%BE/">公共课</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/A2E4D/" rel="tag">A2E4D</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CUDA/" rel="tag">CUDA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPU/" rel="tag">GPU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SD/" rel="tag">SD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLite/" rel="tag">SQLite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/conda/" rel="tag">conda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curl/" rel="tag">curl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/environment/" rel="tag">environment</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ppo/" rel="tag">ppo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell%E8%84%9A%E6%9C%AC/" rel="tag">shell脚本</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/transformers/" rel="tag">transformers</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win/" rel="tag">win</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8B%E8%BD%BD/" rel="tag">下载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" rel="tag">多进程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5-%E5%8D%8F%E7%A8%8B/" rel="tag">异步&#x2F;协程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" rel="tag">数据处理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/" rel="tag">文件传输</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/" rel="tag">模型训练</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2/" rel="tag">模型部署</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/" rel="tag">版本管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8C%AB%E5%9B%BD%E5%BB%BA%E8%AE%BE%E8%80%85/" rel="tag">猫国建设者</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%8B%E5%88%80%E9%B1%BC-%E6%98%AF%E5%A4%A7%E8%87%A3%E7%B2%BE%E8%AE%B2/" rel="tag">秋刀鱼-是大臣精讲</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0%E7%AE%A1%E7%90%86/" rel="tag">笔记管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E7%A8%8B/" rel="tag">线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%98%E5%9B%BE/" rel="tag">绘图</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E7%84%B6%E5%93%B2%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86/" rel="tag">自然哲学的数学原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD%E5%85%94%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">英语兔语法学习笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87/" rel="tag">论文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/" rel="tag">软件工程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%BB%91%E7%A7%91%E6%8A%80/" rel="tag">黑科技</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/A2E4D/" style="font-size: 10px;">A2E4D</a> <a href="/tags/CUDA/" style="font-size: 10px;">CUDA</a> <a href="/tags/Elasticsearch/" style="font-size: 12px;">Elasticsearch</a> <a href="/tags/GPU/" style="font-size: 10px;">GPU</a> <a href="/tags/SD/" style="font-size: 10px;">SD</a> <a href="/tags/SQLite/" style="font-size: 10px;">SQLite</a> <a href="/tags/conda/" style="font-size: 12px;">conda</a> <a href="/tags/curl/" style="font-size: 10px;">curl</a> <a href="/tags/docker/" style="font-size: 14px;">docker</a> <a href="/tags/environment/" style="font-size: 14px;">environment</a> <a href="/tags/github/" style="font-size: 12px;">github</a> <a href="/tags/latex/" style="font-size: 10px;">latex</a> <a href="/tags/linux/" style="font-size: 20px;">linux</a> <a href="/tags/ppo/" style="font-size: 10px;">ppo</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/shell%E8%84%9A%E6%9C%AC/" style="font-size: 10px;">shell脚本</a> <a href="/tags/ssh/" style="font-size: 12px;">ssh</a> <a href="/tags/transformers/" style="font-size: 10px;">transformers</a> <a href="/tags/win/" style="font-size: 12px;">win</a> <a href="/tags/%E4%B8%8B%E8%BD%BD/" style="font-size: 10px;">下载</a> <a href="/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" style="font-size: 10px;">多进程</a> <a href="/tags/%E5%BC%82%E6%AD%A5-%E5%8D%8F%E7%A8%8B/" style="font-size: 10px;">异步/协程</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" style="font-size: 14px;">数据处理</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/" style="font-size: 10px;">文件传输</a> <a href="/tags/%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/" style="font-size: 12px;">模型训练</a> <a href="/tags/%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2/" style="font-size: 10px;">模型部署</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 12px;">爬虫</a> <a href="/tags/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/" style="font-size: 10px;">版本管理</a> <a href="/tags/%E7%8C%AB%E5%9B%BD%E5%BB%BA%E8%AE%BE%E8%80%85/" style="font-size: 10px;">猫国建设者</a> <a href="/tags/%E7%A7%8B%E5%88%80%E9%B1%BC-%E6%98%AF%E5%A4%A7%E8%87%A3%E7%B2%BE%E8%AE%B2/" style="font-size: 10px;">秋刀鱼-是大臣精讲</a> <a href="/tags/%E7%AC%94%E8%AE%B0%E7%AE%A1%E7%90%86/" style="font-size: 12px;">笔记管理</a> <a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 10px;">线程</a> <a href="/tags/%E7%BB%98%E5%9B%BE/" style="font-size: 10px;">绘图</a> <a href="/tags/%E8%87%AA%E7%84%B6%E5%93%B2%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86/" style="font-size: 14px;">自然哲学的数学原理</a> <a href="/tags/%E8%8B%B1%E8%AF%AD%E5%85%94%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 16px;">英语兔语法学习笔记</a> <a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 12px;">论文</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/" style="font-size: 10px;">软件工程</a> <a href="/tags/%E9%BB%91%E7%A7%91%E6%8A%80/" style="font-size: 18px;">黑科技</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">July 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/05/">May 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/04/">April 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">January 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/09/18/aaa/">aaa</a>
          </li>
        
          <li>
            <a href="/2025/09/18/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2025/07/10/pool/2025-07-10-%E6%89%B9%E9%87%8F%E8%B0%83%E6%95%B4python%E8%84%9A%E6%9C%ACimport%E9%A1%BA%E5%BA%8F/">批量调整python脚本import顺序</a>
          </li>
        
          <li>
            <a href="/2025/05/22/pool/2025-05-22-sphinx%E6%96%87%E6%A1%A3%E6%9E%84%E5%BB%BA%E7%AC%94%E8%AE%B0/">sphinx文档构建笔记</a>
          </li>
        
          <li>
            <a href="/2025/05/06/pool/2025-05-06-AIR%20A%20Systematic%20Analysis%20of%20Annotations,%20Instructions,%20and%20Response%20Pairs%20in%20Preference%20Dataset/">AIR: A Systematic Analysis of Annotations, Instructions, and Response Pairs in Preference Dataset</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>